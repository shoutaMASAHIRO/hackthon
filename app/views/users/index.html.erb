<h2 class="section-title">ユーザー一覧</h2>
<% if params[:q].present? %>
  <p class="search-meta">
    「<strong><%= h params[:q] %></strong>」の検索結果（<%= @users.size %>件）
  </p>
<% end %>

<div class="container">
  <style>
    :root{
      --bg:#fff;--fg:#0f1419;--muted:#536471;--border:#e6ecf0;
      --accent:#1d9bf0;--accent-contrast:#fff;--pill-bg:#eff3f4;--pill-fg:#0f1419;
      --shadow:0 8px 20px rgba(15,20,25,.05)
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#000;--fg:#e6e9ea;--muted:#8b98a5;--border:#2f3336;
        --accent:#1d9bf0;--accent-contrast:#000;--pill-bg:#16181c;--pill-fg:#e6e9ea;
        --shadow:0 8px 20px rgba(0,0,0,.35)
      }
    }

    .container{max-width:760px;margin:12px 0 0;padding:0 0 8px;color:var(--fg)}
    .section-title{margin:0 0 8px;font-size:1.4rem;font-weight:700;color:#000!important}
    .search-meta{color:#666;margin:6px 0 12px}

    /* 一覧本体 */
    .user-list{list-style:none;margin:0;padding:0;display:grid;grid-template-columns:1fr;gap:10px}
    .user-card-link{display:block;text-decoration:none!important;color:inherit;border-radius:12px}
    .user-item{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      border:1px solid var(--border);border-radius:12px;background:var(--bg);
      padding:12px 14px;box-shadow:var(--shadow);
      transition:background .15s,border-color .15s,transform .06s,color .15s
    }
    .user-main{display:flex;align-items:center;gap:8px;flex-wrap:wrap;min-width:0}
    .user-name{font-weight:700;white-space:nowrap}
    .user-email{opacity:.95}
    .user-date{color:var(--muted);white-space:nowrap}
    .user-stats{color:var(--muted);white-space:nowrap;flex:0 0 auto}
    .pill{background:var(--pill-bg);color:var(--pill-fg);border:1px solid var(--border);border-radius:999px;padding:4px 10px;font-size:.85rem;font-weight:600}

    /* ホバー：青反転＋文字は白へ、下線なし＆余計な枠なし */
    .user-card-link:hover .user-item,
    .user-card-link:focus-visible .user-item{
      background:var(--accent);border-color:var(--accent);transform:translateY(-2px);box-shadow:0 0 0 3px rgba(29,155,240,.35)
    }
    .user-card-link:hover .user-name,
    .user-card-link:hover .user-email,
    .user-card-link:hover .user-date,
    .user-card-link:hover .user-stats,
    .user-card-link:focus-visible .user-name,
    .user-card-link:focus-visible .user-email,
    .user-card-link:focus-visible .user-date,
    .user-card-link:focus-visible .user-stats{color:var(--accent-contrast)!important}
    .user-card-link:hover .pill,
    .user-card-link:focus-visible .pill{background:rgba(255,255,255,.18);border-color:rgba(255,255,255,.35);color:var(--accent-contrast)}

    .user-card-link:focus-visible{outline:none;box-shadow:none}

    @media (max-width:560px){
      .user-item{flex-direction:column;align-items:flex-start;gap:6px}
      .user-stats{margin-top:4px}
    }
    @media (prefers-reduced-motion: reduce){
      .user-item{transition:none}
    }

    .user-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  grid-template-columns: 1fr;
  gap: 10px;
}

.user-card-link {
  display: block;
  text-decoration: none !important;
  color: inherit;
  border-radius: 12px;
}

.user-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  border: 1px solid var(--border);
  border-radius: 12px;
  background: var(--bg);
  padding: 12px 14px;
  box-shadow: var(--shadow);
  transition: border-color .15s, transform .06s;
}

.user-main {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  min-width: 0;
}

.user-name,
.user-email,
.user-date,
.user-stats {
  color: var(--fg); /* 常に対色 */
}

.user-name { font-weight: 700; white-space: nowrap; }
.user-email { opacity: .95; }
.user-date,
.user-stats { font-size: .9rem; white-space: nowrap; }

.pill {
  background: var(--bg);   /* pill背景＝背景色と同じ */
  color: var(--fg);        /* pill文字＝対色 */
  border: 1px solid var(--border);
  border-radius: 999px;
  padding: 4px 10px;
  font-size: .85rem;
  font-weight: 600;
}

/* ホバー時は枠線を青にするだけ。背景・文字は対色を維持 */
.user-card-link:hover .user-item,
.user-card-link:focus-visible .user-item {
  border-color: var(--accent);
  transform: translateY(-2px);
  box-shadow: 0 0 0 3px rgba(29,155,240,.15);
}

.user-card-link:focus-visible {
  outline: none;
  box-shadow: none;
}


/* ===== スペーシング拡張 & センター寄せ ===== */

/* コンテナはそのまま中央寄せ。左右の余白だけ少し広げたい場合は max-width を軽く増やす */
.container { max-width: 820px; }

/* ===== スペーシング拡張（+20%版） ===== */

.user-list{
  gap: 20px;                 /* 行間 16px → 20px */
  justify-items: center;
}

.user-card-link{
  width: 100%;
  max-width: 720px;
}

.user-item{
  width: 100%;
  padding: 20px 22px;        /* 16px 18px → 約20%UP */
  gap: 20px;                 /* 16px → 20px */
}

.user-main{
  gap: 14px;                 /* 12px → 14px */
  row-gap: 8px;              /* 6px → 8px */
}

.pill + .pill { margin-left: 10px; } /* 8px → 10px */

/* モバイル時も少し広げる */
@media (max-width: 560px){
  .user-item{ gap: 12px; }
  .user-stats{ margin-top: 8px; }
}

  </style>

  <ul class="user-list">
    <% @users.each do |u| %>
      <%= link_to user_path(u), class: "user-card-link", aria: { label: "#{u.name.presence || u.email} のプロフィールへ（カード全体）" } do %>
        <li class="user-item">
          <div class="user-main">
            <span class="user-name"><%= u.name.presence || "(no name)" %></span>
            <span class="user-email"><%= u.email %></span>
            <span class="user-date">登録日: <%= l u.created_at.in_time_zone('Asia/Tokyo'), format: :short %></span>
          </div>
          <div class="user-stats">
            <span class="pill">投稿 <strong><%= u.posts.count %></strong></span>
            <span class="pill" style="margin-left:6px">コメント <strong><%= u.comments.count %></strong></span>
            <span class="pill" style="margin-left:6px">いいね <strong><%= u.likes.count %></strong></span>
          </div>
        </li>
      <% end %>
    <% end %>
  </ul>
</div>
<!-- ↓ ページの“下部”に置く -->
<div class="pagination-wrapper">
  <%= paginate @users %>
</div>
