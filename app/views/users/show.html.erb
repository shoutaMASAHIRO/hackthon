<div class="container">
<style>
  :root{
    --bg:#fff;--fg:#0f1419;--muted:#536471;--border:#e6ecf0;
    --accent:#1d9bf0;--accent-contrast:#fff;--pill-bg:#eff3f4;--pill-fg:#0f1419;
    --shadow:0 8px 20px rgba(15,20,25,.05)
  }
  @media (prefers-color-scheme: dark){
    :root{
      --bg:#000;--fg:#e6e9ea;--muted:#8b98a5;--border:#2f3336;
      --accent:#1d9bf0;--accent-contrast:#000;--pill-bg:#16181c;--pill-fg:#e6e9ea;
      --shadow:0 8px 20px rgba(0,0,0,.35)
    }
  }

  .container{max-width:760px;margin:24px auto;padding:0 16px;color:var(--fg)}
  .as-link{display:inline-flex;align-items:center;gap:.5rem;text-decoration:none;color:var(--accent);padding:6px 10px;border-radius:999px;font-weight:600;transition:background .15s,color .15s,box-shadow .15s}
  .as-link:hover,.as-link:focus-visible{background:var(--accent);color:var(--accent-contrast);text-decoration:none;box-shadow:0 0 0 3px rgba(29,155,240,.35);outline:none}

  .profile-card{background:var(--bg);border:1px solid var(--border);border-radius:16px;padding:20px;box-shadow:var(--shadow);transition:background .15s,color .15s,transform .06s,border-color .15s,box-shadow .15s}
  .profile-header{display:flex;align-items:center;gap:16px}
  .avatar{width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#a5d8ff,#1d9bf0);flex:0 0 auto;border:1px solid var(--border)}
  .profile-title{margin:0;font-size:1.25rem;line-height:1.3;font-weight:800;color:var(--fg);letter-spacing:.01em}
  .profile-meta{margin:4px 0 0;font-size:.95rem;color:var(--muted)}
  .stats{display:flex;flex-wrap:wrap;gap:8px;margin-top:16px}
  .pill{background:var(--pill-bg);color:var(--pill-fg);border:1px solid var(--border);border-radius:999px;padding:6px 12px;font-size:.9rem;font-weight:600}
  hr.sep{border:none;border-top:1px solid var(--border);margin:24px 0}

  .section-header{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:12px}
  .section-title{margin:0;font-size:1.1rem;font-weight:700;color:#000 !important}

  .post-list{list-style:none;padding:0;margin:0;display:grid;grid-template-columns:1fr;gap:10px}
  .post-item{display:flex;align-items:baseline;justify-content:space-between;gap:12px;border:1px solid var(--border);border-radius:12px;padding:12px 14px;background:var(--bg);transition:border-color .15s,transform .06s,background .15s}
  .post-item:hover{border-color:var(--accent);background:var(--accent);transform:translateY(-2px)}
  .post-title{margin:0;font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--fg)}
  .post-item:hover .post-title,.post-item:hover .post-date,.post-item:hover a{color:var(--accent-contrast)!important}
  .post-date{margin:0 0 0 8px;font-size:.85rem;color:var(--muted);white-space:nowrap;flex:0 0 auto}

  .footer-link{margin-top:16px}
  .section-header .as-link,.footer-link .as-link{color:#000!important}
  .section-header .as-link:hover,.section-header .as-link:focus-visible,
  .footer-link .as-link:hover,.footer-link .as-link:focus-visible{color:#000!important;text-decoration:none}

  /* カード全体リンク */
  .profile-card-link{display:block;text-decoration:none;color:inherit;border-radius:16px}
  .profile-card-link:hover .profile-card,.profile-card-link:focus-visible .profile-card{background:var(--accent);border-color:var(--accent);transform:translateY(-2px);box-shadow:0 0 0 3px rgba(29,155,240,.35)}
  .profile-card-link:hover .profile-title,.profile-card-link:hover .profile-meta,.profile-card-link:hover .pill,.profile-card-link:hover .pill strong,
  .profile-card-link:focus-visible .profile-title,.profile-card-link:focus-visible .profile-meta,.profile-card-link:focus-visible .pill,.profile-card-link:focus-visible .pill strong{color:var(--accent-contrast)!important}
  .profile-card-link:hover .avatar,.profile-card-link:focus-visible .avatar{border-color:rgba(255,255,255,.5)}
  .profile-card-link:hover .pill,.profile-card-link:focus-visible .pill{background:rgba(255,255,255,.18);border-color:rgba(255,255,255,.35)}
  .profile-card-link:focus-visible{outline:none}

  /* 投稿カード全体リンク */
  .post-card-link{display:block;text-decoration:none!important;color:inherit;border-radius:12px}
  .post-card-link:hover,.post-card-link:focus,.post-card-link:focus-visible{text-decoration:none!important;outline:none;box-shadow:none}
  .post-card-link:hover .post-item,.post-card-link:focus-visible .post-item{background:var(--accent);border-color:var(--accent);transform:translateY(-2px)}
  .post-card-link:hover .post-title,.post-card-link:hover .post-date,
  .post-card-link:focus-visible .post-title,.post-card-link:focus-visible .post-date{color:var(--accent-contrast)!important}

  @media (prefers-reduced-motion: reduce){.as-link,.post-item,.profile-card{transition:none}}
</style>


  <%= link_to user_path(@user),
              class: "profile-card-link",
              aria: { label: "#{@user.name.presence || @user.email} のプロフィールページへ（カード全体）" } do %>
    <div class="profile-card">
      <div class="profile-header">
        <div class="avatar" aria-hidden="true"></div>
        <div>
          <h2 class="profile-title"><%= @user.name.presence || @user.email %> のプロフィール</h2>
          <p class="profile-meta">
            <%= @user.email %> ・ 登録日:
            <%= l @user.created_at.in_time_zone('Asia/Tokyo'), format: :long %>
          </p>
        </div>
      </div>

      <div class="stats" role="list" aria-label="ユーザーの活動サマリー">
        <span class="pill" role="listitem">投稿 <strong><%= @user.posts.count %></strong></span>
        <span class="pill" role="listitem">コメント <strong><%= @user.comments.count %></strong></span>
        <span class="pill" role="listitem">いいね <strong><%= @user.likes.count %></strong></span>
      </div>
    </div>
  <% end %>

  <hr class="sep">

  <div class="section-header">
    <h3 class="section-title">投稿一覧</h3>
    <%= link_to posts_path, class: "as-link", aria: { label: "投稿一覧ページへ" } do %>
      一覧へ
    <% end %>
  </div>

  <% if @posts.any? %>
    <ul class="post-list">
      <% @posts.each do |post| %>
        <%= link_to post_path(post), class: "post-card-link", aria: { label: "#{post.title} の詳細へ（カード全体）" } do %>
          <li class="post-item">
            <p class="post-title"><%= post.title %></p>
            <p class="post-date">
              作成: <%= l post.created_at.in_time_zone('Asia/Tokyo'), format: :short %>
            </p>
          </li>
        <% end %>
      <% end %>
    </ul>
  <% else %>
    <p class="profile-meta">まだ投稿がありません。</p>
  <% end %>

  <p class="footer-link">
    <%= link_to "ユーザー一覧に戻る", users_path, class: "as-link", aria: { label: "ユーザー一覧に戻る" } %>
  </p>
</div>
